# created a database 
use database end_to_end;
# carrier table creation
create table dim_carrier(
carrier_code string primary key,
carrier_name string
);
#airport table creation
create table dim_airport(
origin_airport_code string,
dest_airport_code string
);
#date table creation
create table dim_date(
flight_date date primary key,
quarter varchar(10),
is_weekend boolean
);
#flights table creation
create table fact_flights(
flight_date_id date references dim_date(flight_date),
 OP_CARRIER_FL_NUM varchar(10),
 OP_CARRIER string references dim_carrier(carrier_code),
 origin_code string,
 dest_code string,
 CRS_DEP_TIME time, 
 DEP_TIME time, 
 DEP_DELAY float, 
 TAXI_OUT float, 
 TAXI_IN float, 
 CRS_ARR_TIME time, 
 ARR_TIME time, 
 ARR_DELAY float, 
 CANCELLED float, 
 CANCELLATION_CODE string, 
 DIVERTED float, 
 CRS_ELAPSED_TIME float,
 ACTUAL_ELAPSED_TIME float,
 DISTANCE float, 
 CARRIER_DELAY float, 
 WEATHER_DELAY float, 
 NAS_DELAY float, 
 SECURITY_DELAY float, 
 LATE_AIRCRAFT_DELAY float, 
 quarter1 varchar,
 Flight_Status string, 
 Ground_Time float,
 month_flight int
);
#staging airport table creation
create table dim_staging_airport(
origin_airport_code string,
dest_airport_code string
);
#staging carrier table creation
create table dim_carrier_staging(
carrier_code string primary key,
carrier_name string
);
